{% set component_map =
{
  'Android':['Java-Android', 'Kotlin', 'Kotlin-Android', 'LiteCore'],
  'C':['C', 'LiteCore'],
  '.NET':['.NET', 'LiteCore'],
  'Java':['Java', 'Java-Android', 'Kotlin-Android'],
  'Javascript':['Kotlin', 'LiteCore'],
  'Objective-C':['IOS', 'LiteCore'],
  'Swift':['IOS', 'LiteCore']
} -%}

{% set filtered_issues = issues | filter_by_component(component_map[user_settings.fields['module']]) %}

// tag::issues-{{ user_settings.fields.release_number | replace_dots('-') }}[]

== Fixed

// tag::Fixed-{{ user_settings.fields.release_number | replace_dots('-') }}[]

{% for issue in filtered_issues
| selectattr('fields.issuetype.name', 'in', 'Bug')
| selectattr('fields.status.name', 'in','Resolved, Closed')
| selectattr('fields.resolution.name', 'in','Fixed, Done')
| rejectattr('fields.labels', 'contains', 'known_issue') %}

* {{ user_settings.release_set.url }}/browse/{{ issue.key }}[++{{ issue.key }} — {{ issue.fields.summary }}++]

{% endfor %}

// end::Fixed-{{ user_settings.fields.release_number | replace_dots('-') }}[]

== Enhancements

// tag::Enhancements-{{ user_settings.fields.release_number | replace_dots('-') }}[]

{% for issue in filtered_issues
| selectattr('fields.issuetype.name', 'in', 'Improvement')
| selectattr('fields.status.name', 'in','Resolved, Closed')
| selectattr('fields.resolution.name', 'in','Fixed, Done')
| rejectattr('fields.labels', 'contains', 'known_issue') %}

* {{ user_settings.release_set.url }}/browse/{{ issue.key }}[++{{ issue.key }} — {{ issue.fields.summary }}++]

{% endfor %}

// end::Enhancements-{{ user_settings.fields.release_number | replace_dots('-') }}[]

== Known Issues

// tag::KI-{{ user_settings.fields.release_number | replace_dots('-') }}[]

{% for issue in filtered_issues | selectattr('fields.labels', 'contains', 'known_issue')
| rejectattr('fields.status.name', 'in','Resolved, Closed') %}

* {{ user_settings.release_set.url }}/browse/{{ issue.key }}[++{{ issue.key }} — {{ issue.fields.summary }}++]

{% endfor %}

// end::KI-{{ user_settings.fields.release_number | replace_dots('-') }}[]

// end::issues-{{ user_settings.fields.release_number | replace_dots('-') }}[]

